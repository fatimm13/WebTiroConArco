<html>
	<head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">

		<title>Torneo</title>
        <script>
            var nombre = getQuery("nombre");
            var tipo = getQuery("tipo");
            var edad = getQuery("rondas");

            var usuario = new Persona(nombre,0,0,0);

            var participantes = ["Magdalena","Francisco","Emilia","Pedro"]
            var puntuaciones = new Array();
            function Persona(nombre, puntuacion, nueves, dieces){
                this.nombre = nombre;
                this.puntuacion = puntuacion;
                this.nueves = nueves;
                this.dieces = dieces;
            }

            function comparePersona(a,b) {
                let i = a.puntuacion-b.puntuacion;

                if(i==0){
                    i = a.dieces - b.dieces;
                    if(i==0){
                        i=a.nueves - b.nueves;
                    }
                }

                return -i;
            };

            function getQuery(q) {
                return (window.location.search.match(new RegExp('[?&]' + q + '=([^&]+)')) || [, null])[1];
            }

            function cargaNombre(){
                document.body.innerHTML=nombre;
            }

            function load(){
                

                for(var i = 0;i<participantes.length;i++){
                    let n = getRandomInt(0,5);
                    let d = getRandomInt(0,5);
                    let p = 9*n + 10*d + getRandomInt(0,205);

                    puntuaciones.push(new Persona(participantes[i],p,n,d));
                }

                puntuaciones.push(usuario);

                puntuaciones.sort(comparePersona);

                let table = document.getElementById("tabla");
                for(var i = 1;i<=puntuaciones.length;i++){
                    let row = table.insertRow(i);
                    row.insertCell(0).innerHTML = i;
                    row.insertCell(1).innerHTML = puntuaciones[i-1].nombre;
                    row.insertCell(2).innerHTML = puntuaciones[i-1].puntuacion;
                    if (i == 1) {
                        row.classList.add("table-warning");
                        row.classList.remove("table-striped");
                    } else if (i == 2) {
                        row.classList.add("table-danger");
                        row.classList.remove("table-striped");
                    } else if (i == 3) {
                        row.classList.add("table-info");
                        row.classList.remove("table-striped");
                    }
                    if (puntuaciones[i-1] === usuario) {
                        row.classList.add("fw-bold");
                    }
                }

            }

            function getRandomInt(min, max) {
                return Math.floor(Math.random() * (max - min)) + min;
            }

            window.onload = load;
        </script>
	</head>
	<body>

        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="index.html">
                    <img src="diana.png" alt="Imagen de una diana" width="30" height="30" class="d-inline-block align-text-top">
                    Tiro con arco
                </a>
            </div>
        </nav>

        <div class="table-responsive" style="padding: 2%;">
            <table id = "tabla" class="table table-striped">
                <thead class="table-dark">
                    <tr>
                        <th scope="col">Puesto</th>
                        <th scope="col">Nombre</th>
                        <th scope="col">Puntuaciones</th>
                    </tr>
                </thead>
                <tbody class="table-light">
                    <tr></tr>
                </tbody>
            </table>

        </div>

        <div class="container-fluid fs-5" style="padding-left: 2%;">

            <div class="row">
            
                <div class="col-sm-8" style="padding-left: 5%; padding-right: 5%;">
                    <div class="row">
                        <div class="col-sm-4">
                            <div class="input-group">
                                <span class="input-group-text">Puntuación</span>
                                <input type="number" min="0" max="10" class="form-control" id="puntuacion" maxlength="2" size="2">
                                <button class="btn btn-outline-secondary" type="button">Añadir</button>
                            </div>
                        </div>
                        <div class="col-sm-8">
                            <textarea class="form-control" id="listaPuntuaciones" rows="10" readonly></textarea>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="col-sm-8">
                    <div class="input-group">
                        <span class="input-group-text fw-bold">Cantidad de 9 </span>
                        <span class="input-group-text" id="nueves"> 0 </span>
                    </div>
                    <br/>
                    <div class="input-group">
                        <span class="input-group-text fw-bold">Cantidad de 10</span>
                        <span class="input-group-text" id="dieces"> 0 </span>
                    </div>
                    <br/>
                    <br/>
                    <br/>
                    <div class="input-group">
                        <span class="input-group-text fw-bold">Puntuacion total</span>
                        <span class="input-group-text" id="total"> 0 </span>
                    </div>
                </div>
                </div>
            </div>
        </div>

	</body>
</html>